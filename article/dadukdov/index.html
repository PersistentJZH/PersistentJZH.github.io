<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.24" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.157" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"SSL/TLS握手原理详解","image":[""],"dateModified":"2025-10-25T15:12:58.000Z","author":[]}</script><meta property="og:url" content="https://blog.jianzhihao.icu/article/dadukdov/"><meta property="og:site_name" content="ZH Blog"><meta property="og:title" content="SSL/TLS握手原理详解"><meta property="og:description" content="SSL（Secure Sockets Layer）和TLS（Transport Layer Security）是网络安全中最重要的协议之一，它们为网络通信提供了加密、身份验证和数据完整性保护。本文将深入探讨SSL/TLS握手过程的原理和实现细节。 1. SSL/TLS协议概述 1.1 什么是SSL/TLS SSL（Secure Sockets Laye..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-10-25T15:12:58.000Z"><meta property="article:modified_time" content="2025-10-25T15:12:58.000Z"><link rel="icon" type="image/png" href="https://theme-plume.vuejs.press/favicon-32x32.png"><title>SSL/TLS握手原理详解 | ZH Blog</title><meta name="description" content="SSL（Secure Sockets Layer）和TLS（Transport Layer Security）是网络安全中最重要的协议之一，它们为网络通信提供了加密、身份验证和数据完整性保护。本文将深入探讨SSL/TLS握手过程的原理和实现细节。 1. SSL/TLS协议概述 1.1 什么是SSL/TLS SSL（Secure Sockets Laye..."><link rel="preload" href="/assets/style-D3gcUh-r.css" as="style"><link rel="stylesheet" href="/assets/style-D3gcUh-r.css"><link rel="modulepreload" href="/assets/app-Bx6_S8_t.js"><link rel="modulepreload" href="/assets/index.html-CjHaGpN-.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-d90a7a26><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d5a8d0bc></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-d5a8d0bc> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-d90a7a26 data-v-e98a6132><div class="vp-navbar" vp-navbar data-v-e98a6132 data-v-2c31ea5e><div class="wrapper" data-v-2c31ea5e><div class="container" data-v-2c31ea5e><div class="title" data-v-2c31ea5e><div class="vp-navbar-title" data-v-2c31ea5e data-v-1a4f50af><a class="vp-link link no-icon title" href="/" data-v-1a4f50af><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-480e858a><!--]--><!--[--><img class="vp-image light logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-480e858a><!--]--><!--]--><!--]--><span data-v-1a4f50af>ZH Blog</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-2c31ea5e><div class="content-body" data-v-2c31ea5e><!--[--><!--]--><div class="vp-navbar-search search" data-v-2c31ea5e><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-2c31ea5e data-v-d43c1732><span id="main-nav-aria-label" class="visually-hidden" data-v-d43c1732>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>🏡首页</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>📝博客</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/tags/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>🔖标签</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/archives/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>🗃️归档</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/categories/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>🕹️分类</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/notes/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>📚笔记</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/travel/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>🏖️旅行</span><!----><!--]--><!----></a><!--]--><!--]--></nav><!--[--><!--]--><div class="vp-flyout vp-navbar-translations translations" data-v-2c31ea5e data-v-0d45479b data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="选择语言" data-v-86530b6c><span class="text" data-v-86530b6c><!----><span class="vpi-languages option-icon" data-v-86530b6c></span><!----><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><div class="items" data-v-0d45479b><p class="title" data-v-0d45479b>简体中文</p><!--[--><div class="vp-menu-link" data-v-0d45479b data-v-1ff1855f><a class="vp-link link" href="/en/blog/" data-v-1ff1855f><!--[--><!----> English <!----><!--]--><!----></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="vp-navbar-appearance appearance" data-v-2c31ea5e data-v-a295abf6><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-a295abf6 data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-2c31ea5e data-v-ad52545c data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/PersistentJZH" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-2c31ea5e data-v-652282fd data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-86530b6c><span class="vpi-more-horizontal icon" data-v-86530b6c></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><!----><div class="group" data-v-652282fd><div class="item appearance" data-v-652282fd><p class="label" data-v-652282fd>外观</p><div class="appearance-action" data-v-652282fd><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-652282fd data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-652282fd><div class="item social-links" data-v-652282fd><div class="vp-social-links social-links-list" data-v-652282fd data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/PersistentJZH" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-2c31ea5e data-v-2b50024d><span class="container" data-v-2b50024d><span class="top" data-v-2b50024d></span><span class="middle" data-v-2b50024d></span><span class="bottom" data-v-2b50024d></span></span></button></div></div></div></div><div class="divider" data-v-2c31ea5e><div class="divider-line" data-v-2c31ea5e></div></div></div><!----></header><div class="vp-local-nav fixed reached-top is-blog" data-v-d90a7a26 data-v-3944d8e8><button class="hidden menu" disabled aria-expanded="false" aria-controls="SidebarNav" data-v-3944d8e8><span class="vpi-align-left menu-icon" data-v-3944d8e8></span><span class="menu-text" data-v-3944d8e8>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-3944d8e8 data-v-4114a62c><button data-v-4114a62c>返回顶部</button><!----></div></div><!----><!--[--><div id="VPContent" vp-content class="vp-content" data-v-d90a7a26 data-v-b2beaca7><div class="vp-doc-container is-blog" data-v-b2beaca7 data-v-23f6ad98><!--[--><!--]--><div class="container" data-v-23f6ad98><!----><div class="content" data-v-23f6ad98><div class="content-container" data-v-23f6ad98><!--[--><!--]--><main class="main" data-v-23f6ad98><nav class="vp-breadcrumb" data-v-23f6ad98 data-v-1ae4ad7a><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-1ae4ad7a><!--[--><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="首页" data-v-1ae4ad7a><meta property="position" content="1" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/blog/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->博客<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="博客" data-v-1ae4ad7a><meta property="position" content="2" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/blog/categories/?id=c50d13" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->博客<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="博客" data-v-1ae4ad7a><meta property="position" content="3" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/blog/categories/?id=fb46d6" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->基础<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="基础" data-v-1ae4ad7a><meta property="position" content="4" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb current" href="/article/dadukdov/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->SSL/TLS握手原理详解<!--]--><!----></a><!----><meta property="name" content="SSL/TLS握手原理详解" data-v-1ae4ad7a><meta property="position" content="5" data-v-1ae4ad7a></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-27be53cb>SSL/TLS握手原理详解 <!----></h1><div class="vp-doc-meta" data-v-27be53cb><!--[--><!--]--><p class="reading-time" data-v-27be53cb><span class="vpi-books icon" data-v-27be53cb></span><span data-v-27be53cb>约 2130 字</span><span data-v-27be53cb>大约 7 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-27be53cb><span class="vpi-clock icon" data-v-27be53cb></span><span data-v-27be53cb>2025-10-25</span></p></div><!--]--><!--[--><!--]--><div class="_article_dadukdov_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-23f6ad98><!--[--><!--]--><div data-v-23f6ad98><p>SSL（Secure Sockets Layer）和TLS（Transport Layer Security）是网络安全中最重要的协议之一，它们为网络通信提供了加密、身份验证和数据完整性保护。本文将深入探讨SSL/TLS握手过程的原理和实现细节。</p><h2 id="_1-ssl-tls协议概述" tabindex="-1"><a class="header-anchor" href="#_1-ssl-tls协议概述"><span>1. SSL/TLS协议概述</span></a></h2><h3 id="_1-1-什么是ssl-tls" tabindex="-1"><a class="header-anchor" href="#_1-1-什么是ssl-tls"><span>1.1 什么是SSL/TLS</span></a></h3><p>SSL（Secure Sockets Layer）最初由Netscape公司开发，TLS（Transport Layer Security）是SSL的后续版本。它们都是应用层协议，位于传输层（TCP）之上，为上层应用提供安全的数据传输服务。</p><h3 id="_1-2-主要功能" tabindex="-1"><a class="header-anchor" href="#_1-2-主要功能"><span>1.2 主要功能</span></a></h3><ul><li><strong>加密</strong>：保护数据传输的机密性</li><li><strong>身份验证</strong>：验证通信双方的身份</li><li><strong>数据完整性</strong>：确保数据在传输过程中未被篡改</li></ul><h3 id="_1-3-协议版本演进" tabindex="-1"><a class="header-anchor" href="#_1-3-协议版本演进"><span>1.3 协议版本演进</span></a></h3><ul><li>SSL 1.0：从未公开发布</li><li>SSL 2.0：1995年发布，存在严重安全漏洞</li><li>SSL 3.0：1996年发布，2014年被发现POODLE攻击漏洞</li><li>TLS 1.0：1999年发布，基于SSL 3.0</li><li>TLS 1.1：2006年发布</li><li>TLS 1.2：2008年发布，目前最广泛使用</li><li>TLS 1.3：2018年发布，大幅简化握手过程</li></ul><h2 id="_2-ssl-tls握手过程详解" tabindex="-1"><a class="header-anchor" href="#_2-ssl-tls握手过程详解"><span>2. SSL/TLS握手过程详解</span></a></h2><h3 id="_2-1-握手过程概述" tabindex="-1"><a class="header-anchor" href="#_2-1-握手过程概述"><span>2.1 握手过程概述</span></a></h3><p>SSL/TLS握手是一个复杂的协商过程，主要目的是：</p><ol><li>协商加密算法和参数</li><li>交换密钥材料</li><li>验证身份（可选）</li><li>建立安全连接</li></ol><h3 id="_2-2-tls-1-2握手流程" tabindex="-1"><a class="header-anchor" href="#_2-2-tls-1-2握手流程"><span>2.2 TLS 1.2握手流程</span></a></h3><h4 id="第一步-client-hello" tabindex="-1"><a class="header-anchor" href="#第一步-client-hello"><span>第一步：Client Hello</span></a></h4><p>客户端向服务器发送Client Hello消息，包含：</p><ul><li>支持的TLS版本</li><li>支持的加密套件列表</li><li>随机数（Client Random）</li><li>会话ID（用于会话恢复）</li><li>支持的压缩方法</li><li>扩展信息</li></ul><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Client -&gt; Server: Client Hello</span></span>
<span class="line"><span>├── Version: TLS 1.2</span></span>
<span class="line"><span>├── Random: 32字节随机数</span></span>
<span class="line"><span>├── Cipher Suites: [支持的加密套件列表]</span></span>
<span class="line"><span>├── Compression Methods: [压缩方法]</span></span>
<span class="line"><span>└── Extensions: [扩展信息]</span></span></code></pre></div><h4 id="第二步-server-hello" tabindex="-1"><a class="header-anchor" href="#第二步-server-hello"><span>第二步：Server Hello</span></a></h4><p>服务器响应Server Hello消息，包含：</p><ul><li>选择的TLS版本</li><li>选择的加密套件</li><li>随机数（Server Random）</li><li>会话ID</li><li>选择的压缩方法</li></ul><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Server -&gt; Client: Server Hello</span></span>
<span class="line"><span>├── Version: TLS 1.2</span></span>
<span class="line"><span>├── Random: 32字节随机数</span></span>
<span class="line"><span>├── Cipher Suite: 选择的加密套件</span></span>
<span class="line"><span>├── Session ID: 会话标识</span></span>
<span class="line"><span>└── Compression Method: 选择的压缩方法</span></span></code></pre></div><h4 id="第三步-certificate" tabindex="-1"><a class="header-anchor" href="#第三步-certificate"><span>第三步：Certificate</span></a></h4><p>服务器发送数字证书，包含：</p><ul><li>服务器的公钥</li><li>证书颁发机构（CA）的签名</li><li>证书有效期</li><li>服务器域名信息</li></ul><h4 id="第四步-server-key-exchange-可选" tabindex="-1"><a class="header-anchor" href="#第四步-server-key-exchange-可选"><span>第四步：Server Key Exchange（可选）</span></a></h4><p>如果选择的加密套件需要，服务器发送密钥交换信息：</p><ul><li>服务器的临时公钥（用于密钥交换）</li><li>数字签名（证明服务器拥有私钥）</li></ul><h4 id="第五步-certificate-request-可选" tabindex="-1"><a class="header-anchor" href="#第五步-certificate-request-可选"><span>第五步：Certificate Request（可选）</span></a></h4><p>如果服务器需要客户端身份验证，发送证书请求：</p><ul><li>支持的证书类型</li><li>可接受的CA列表</li></ul><h4 id="第六步-server-hello-done" tabindex="-1"><a class="header-anchor" href="#第六步-server-hello-done"><span>第六步：Server Hello Done</span></a></h4><p>服务器表示握手消息发送完毕。</p><h4 id="第七步-client-certificate-可选" tabindex="-1"><a class="header-anchor" href="#第七步-client-certificate-可选"><span>第七步：Client Certificate（可选）</span></a></h4><p>如果服务器请求客户端证书，客户端发送：</p><ul><li>客户端数字证书</li><li>客户端公钥</li></ul><h4 id="第八步-client-key-exchange" tabindex="-1"><a class="header-anchor" href="#第八步-client-key-exchange"><span>第八步：Client Key Exchange</span></a></h4><p>客户端发送密钥交换信息：</p><ul><li>预主密钥（Pre-Master Secret）</li><li>使用服务器公钥加密</li></ul><h4 id="第九步-certificate-verify-可选" tabindex="-1"><a class="header-anchor" href="#第九步-certificate-verify-可选"><span>第九步：Certificate Verify（可选）</span></a></h4><p>如果发送了客户端证书，客户端发送：</p><ul><li>使用客户端私钥对握手消息的签名</li></ul><h4 id="第十步-change-cipher-spec" tabindex="-1"><a class="header-anchor" href="#第十步-change-cipher-spec"><span>第十步：Change Cipher Spec</span></a></h4><p>客户端通知服务器，后续消息将使用协商的加密参数。</p><h4 id="第十一步-finished" tabindex="-1"><a class="header-anchor" href="#第十一步-finished"><span>第十一步：Finished</span></a></h4><p>客户端发送加密的Finished消息，包含：</p><ul><li>所有握手消息的哈希值</li><li>验证握手过程是否正确</li></ul><h4 id="第十二步-change-cipher-spec" tabindex="-1"><a class="header-anchor" href="#第十二步-change-cipher-spec"><span>第十二步：Change Cipher Spec</span></a></h4><p>服务器通知客户端，后续消息将使用协商的加密参数。</p><h4 id="第十三步-finished" tabindex="-1"><a class="header-anchor" href="#第十三步-finished"><span>第十三步：Finished</span></a></h4><p>服务器发送加密的Finished消息，完成握手。</p><h3 id="_2-3-密钥生成过程" tabindex="-1"><a class="header-anchor" href="#_2-3-密钥生成过程"><span>2.3 密钥生成过程</span></a></h3><h4 id="主密钥-master-secret-生成" tabindex="-1"><a class="header-anchor" href="#主密钥-master-secret-生成"><span>主密钥（Master Secret）生成</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Master Secret = PRF(Pre-Master Secret, &quot;master secret&quot;, Client Random + Server Random)</span></span></code></pre></div><h4 id="会话密钥生成" tabindex="-1"><a class="header-anchor" href="#会话密钥生成"><span>会话密钥生成</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Key Material = PRF(Master Secret, &quot;key expansion&quot;, Server Random + Client Random)</span></span></code></pre></div><p>生成的密钥材料包括：</p><ul><li>客户端写MAC密钥</li><li>服务器写MAC密钥</li><li>客户端写加密密钥</li><li>服务器写加密密钥</li><li>客户端写IV</li><li>服务器写IV</li></ul><h2 id="_3-tls-1-3握手优化" tabindex="-1"><a class="header-anchor" href="#_3-tls-1-3握手优化"><span>3. TLS 1.3握手优化</span></a></h2><h3 id="_3-1-主要改进" tabindex="-1"><a class="header-anchor" href="#_3-1-主要改进"><span>3.1 主要改进</span></a></h3><p>TLS 1.3对握手过程进行了重大优化：</p><ol><li><strong>减少往返次数</strong>：从2个往返减少到1个往返</li><li><strong>移除不安全的加密套件</strong>：只保留安全的加密算法</li><li><strong>简化握手消息</strong>：移除不必要的消息类型</li><li><strong>0-RTT支持</strong>：支持零往返时间的数据传输</li></ol><h3 id="_3-2-tls-1-3握手流程" tabindex="-1"><a class="header-anchor" href="#_3-2-tls-1-3握手流程"><span>3.2 TLS 1.3握手流程</span></a></h3><h4 id="客户端发送client-hello" tabindex="-1"><a class="header-anchor" href="#客户端发送client-hello"><span>客户端发送Client Hello</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Client -&gt; Server: Client Hello</span></span>
<span class="line"><span>├── Version: TLS 1.3</span></span>
<span class="line"><span>├── Random: 32字节随机数</span></span>
<span class="line"><span>├── Cipher Suites: [支持的加密套件]</span></span>
<span class="line"><span>├── Key Share: 客户端密钥交换信息</span></span>
<span class="line"><span>└── Extensions: [扩展信息]</span></span></code></pre></div><h4 id="服务器响应server-hello" tabindex="-1"><a class="header-anchor" href="#服务器响应server-hello"><span>服务器响应Server Hello</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Server -&gt; Client: Server Hello</span></span>
<span class="line"><span>├── Version: TLS 1.3</span></span>
<span class="line"><span>├── Random: 32字节随机数</span></span>
<span class="line"><span>├── Cipher Suite: 选择的加密套件</span></span>
<span class="line"><span>├── Key Share: 服务器密钥交换信息</span></span>
<span class="line"><span>└── Extensions: [扩展信息]</span></span></code></pre></div><h4 id="服务器发送encrypted-extensions" tabindex="-1"><a class="header-anchor" href="#服务器发送encrypted-extensions"><span>服务器发送Encrypted Extensions</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Server -&gt; Client: Encrypted Extensions</span></span>
<span class="line"><span>└── 加密的扩展信息</span></span></code></pre></div><h4 id="服务器发送certificate-可选" tabindex="-1"><a class="header-anchor" href="#服务器发送certificate-可选"><span>服务器发送Certificate（可选）</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Server -&gt; Client: Certificate</span></span>
<span class="line"><span>└── 服务器证书</span></span></code></pre></div><h4 id="服务器发送certificate-verify-可选" tabindex="-1"><a class="header-anchor" href="#服务器发送certificate-verify-可选"><span>服务器发送Certificate Verify（可选）</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Server -&gt; Client: Certificate Verify</span></span>
<span class="line"><span>└── 证书验证信息</span></span></code></pre></div><h4 id="服务器发送finished" tabindex="-1"><a class="header-anchor" href="#服务器发送finished"><span>服务器发送Finished</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Server -&gt; Client: Finished</span></span>
<span class="line"><span>└── 加密的Finished消息</span></span></code></pre></div><h4 id="客户端发送finished" tabindex="-1"><a class="header-anchor" href="#客户端发送finished"><span>客户端发送Finished</span></a></h4><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>Client -&gt; Server: Finished</span></span>
<span class="line"><span>└── 加密的Finished消息</span></span></code></pre></div><h2 id="_4-加密套件详解" tabindex="-1"><a class="header-anchor" href="#_4-加密套件详解"><span>4. 加密套件详解</span></a></h2><h3 id="_4-1-加密套件组成" tabindex="-1"><a class="header-anchor" href="#_4-1-加密套件组成"><span>4.1 加密套件组成</span></a></h3><p>加密套件由以下部分组成：</p><ul><li><strong>密钥交换算法</strong>：RSA、ECDHE、DHE等</li><li><strong>身份验证算法</strong>：RSA、ECDSA、DSA等</li><li><strong>对称加密算法</strong>：AES、3DES、RC4等</li><li><strong>消息认证码</strong>：HMAC-SHA256、HMAC-SHA1等</li></ul><h3 id="_4-2-常见加密套件" tabindex="-1"><a class="header-anchor" href="#_4-2-常见加密套件"><span>4.2 常见加密套件</span></a></h3><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</span></span>
<span class="line"><span>├── 密钥交换：ECDHE（椭圆曲线Diffie-Hellman）</span></span>
<span class="line"><span>├── 身份验证：RSA</span></span>
<span class="line"><span>├── 对称加密：AES-256-GCM</span></span>
<span class="line"><span>└── 消息认证：SHA384</span></span></code></pre></div><h2 id="_5-数字证书详解" tabindex="-1"><a class="header-anchor" href="#_5-数字证书详解"><span>5. 数字证书详解</span></a></h2><h3 id="_5-1-证书结构" tabindex="-1"><a class="header-anchor" href="#_5-1-证书结构"><span>5.1 证书结构</span></a></h3><p>X.509证书包含以下信息：</p><ul><li><strong>版本号</strong>：证书格式版本</li><li><strong>序列号</strong>：证书唯一标识</li><li><strong>签名算法</strong>：用于签名的算法</li><li><strong>颁发者</strong>：证书颁发机构信息</li><li><strong>有效期</strong>：证书有效时间范围</li><li><strong>主体</strong>：证书持有者信息</li><li><strong>公钥</strong>：证书持有者的公钥</li><li><strong>扩展</strong>：其他信息</li><li><strong>签名</strong>：CA的数字签名</li></ul><h3 id="_5-2-证书验证过程" tabindex="-1"><a class="header-anchor" href="#_5-2-证书验证过程"><span>5.2 证书验证过程</span></a></h3><ol><li><strong>检查证书有效期</strong></li><li><strong>验证证书链</strong>：从根CA到终端证书</li><li><strong>检查证书撤销状态</strong>：CRL或OCSP</li><li><strong>验证域名匹配</strong>：检查证书中的域名是否与访问的域名匹配</li></ol><h2 id="_6-安全考虑" tabindex="-1"><a class="header-anchor" href="#_6-安全考虑"><span>6. 安全考虑</span></a></h2><h3 id="_6-1-常见攻击方式" tabindex="-1"><a class="header-anchor" href="#_6-1-常见攻击方式"><span>6.1 常见攻击方式</span></a></h3><ol><li><strong>中间人攻击（MITM）</strong>：攻击者拦截并修改通信</li><li><strong>降级攻击</strong>：强制使用较弱的加密算法</li><li><strong>重放攻击</strong>：重复发送已捕获的消息</li><li><strong>BEAST攻击</strong>：针对CBC模式加密的攻击</li><li><strong>POODLE攻击</strong>：针对SSL 3.0的攻击</li></ol><h3 id="_6-2-防护措施" tabindex="-1"><a class="header-anchor" href="#_6-2-防护措施"><span>6.2 防护措施</span></a></h3><ol><li><strong>使用强加密算法</strong>：避免使用已知的弱算法</li><li><strong>定期更新证书</strong>：确保证书在有效期内</li><li><strong>启用HSTS</strong>：强制使用HTTPS</li><li><strong>证书透明度</strong>：监控证书颁发情况</li><li><strong>定期安全审计</strong>：检查配置和实现</li></ol><h2 id="_7-性能优化" tabindex="-1"><a class="header-anchor" href="#_7-性能优化"><span>7. 性能优化</span></a></h2><h3 id="_7-1-会话恢复" tabindex="-1"><a class="header-anchor" href="#_7-1-会话恢复"><span>7.1 会话恢复</span></a></h3><ul><li><strong>会话ID</strong>：服务器保存会话信息，客户端可以重用</li><li><strong>会话票据</strong>：客户端保存加密的会话信息</li></ul><h3 id="_7-2-0-rtt优化" tabindex="-1"><a class="header-anchor" href="#_7-2-0-rtt优化"><span>7.2 0-RTT优化</span></a></h3><p>TLS 1.3支持0-RTT，允许客户端在握手完成前发送数据，但需要注意重放攻击的风险。</p><h3 id="_7-3-硬件加速" tabindex="-1"><a class="header-anchor" href="#_7-3-硬件加速"><span>7.3 硬件加速</span></a></h3><ul><li><strong>AES-NI指令集</strong>：CPU硬件加速AES加密</li><li><strong>专用加密芯片</strong>：硬件加速加密运算</li></ul><h2 id="_8-实际应用" tabindex="-1"><a class="header-anchor" href="#_8-实际应用"><span>8. 实际应用</span></a></h2><h3 id="_8-1-web服务器配置" tabindex="-1"><a class="header-anchor" href="#_8-1-web服务器配置"><span>8.1 Web服务器配置</span></a></h3><div class="language-nginx" data-highlighter="shiki" data-ext="nginx" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-nginx"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Nginx SSL配置示例</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">server</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    listen </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">443</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ssl http2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    server_name </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">example.com</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ssl_certificate </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/path/to/certificate.crt</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ssl_certificate_key </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/path/to/private.key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 安全配置</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ssl_protocols </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">TLSv1.2 TLSv1.3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ssl_ciphers </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ssl_prefer_server_ciphers on</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # HSTS</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    add_header </span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Strict-Transport-Security </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;max-age=31536000; includeSubDomains&quot;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> always</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre></div><h3 id="_8-2-客户端验证" tabindex="-1"><a class="header-anchor" href="#_8-2-客户端验证"><span>8.2 客户端验证</span></a></h3><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 使用openssl测试SSL连接</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> s_client</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -connect</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> example.com:443</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -servername</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> example.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 检查证书信息</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> x509</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> certificate.crt</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -text</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -noout</span></span></code></pre></div><h2 id="_9-总结" tabindex="-1"><a class="header-anchor" href="#_9-总结"><span>9. 总结</span></a></h2><p>SSL/TLS握手是网络安全的基础，理解其原理对于：</p><ol><li><strong>安全配置</strong>：正确配置服务器和客户端</li><li><strong>问题排查</strong>：快速定位连接问题</li><li><strong>性能优化</strong>：选择合适的加密算法和参数</li><li><strong>安全审计</strong>：评估系统的安全状态</li></ol><p>随着TLS 1.3的普及，握手过程变得更加高效和安全。在实际应用中，应该：</p><ul><li>优先使用TLS 1.3</li><li>选择安全的加密套件</li><li>定期更新证书</li><li>启用安全扩展（HSTS、证书透明度等）</li><li>进行定期的安全审计</li></ul><p>通过深入理解SSL/TLS握手原理，我们可以更好地保护网络通信的安全，为用户提供安全可靠的服务。</p></div><!----><!--[--><h2 id="doc-changelog" tabindex="-1"><a href="#doc-changelog" class="header-anchor"><span>更新日志</span></a></h2><div class="vp-changelog-wrapper"><div class="vp-changelog-header"><div class="vp-latest-updated"><span class="vp-changelog-icon"></span><span data-allow-mismatch>2025/10/25 15:12</span></div><div><span class="vp-changelog-menu-icon"></span><span>查看所有更新日志</span></div></div><ul class="vp-changelog-list"><!--[--><li class="vp-changelog-item-commit"><span class="vp-changelog-hash" target="_blank" rel="noreferrer"><code>519ec</code></span><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">add ssl</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-10-25T15:12:58.000Z">2025/10/25</time></span></li><!--]--></ul></div><!--]--><!----></div></main><footer class="vp-doc-footer" data-v-23f6ad98 data-v-fda6bbae><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-fda6bbae><span class="contributors-label" data-v-fda6bbae>贡献者: </span><span class="contributors-info" data-v-fda6bbae><!--[--><!--[--><span class="contributor" data-v-fda6bbae>PersistentJZH</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-fda6bbae><div class="pager" data-v-fda6bbae><!----></div><div class="pager" data-v-fda6bbae><a class="vp-link link pager-link next" href="/article/4eljv07f/" data-v-fda6bbae><!--[--><span class="desc" data-v-fda6bbae>下一页</span><span class="title" data-v-fda6bbae>gc</span><!--]--><!----></a></div></nav></footer><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;" data-v-23f6ad98><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-d90a7a26 data-v-bcf8d9a6><span class="percent" data-allow-mismatch data-v-bcf8d9a6>0%</span><span class="show icon vpi-back-to-top" data-v-bcf8d9a6></span><svg aria-hidden="true" data-v-bcf8d9a6><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-bcf8d9a6></circle></svg></button><footer class="vp-footer" vp-footer data-v-d90a7a26 data-v-400675cf><!--[--><div class="container" data-v-400675cf><!----><p class="copyright" data-v-400675cf>to take the days count</p></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-Bx6_S8_t.js" defer></script></body></html>